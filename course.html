<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruang Kelas</title>
    <style>
        body { font-family: Tahoma, sans-serif; background-color: #f4f7f6; margin: 0; padding: 20px; }
        .container { background: white; padding: 30px; max-width: 600px; margin: auto; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box;}
        button { width: 100%; padding: 10px; background-color: #2ecc71; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .btn-back { background-color: #95a5a6; margin-bottom: 20px; width: auto; padding: 8px 15px;}
    </style>
</head>
<body>

<div class="container">
    <button class="btn-back" onclick="window.location.href='dashboard.html'">Kembali ke Dashboard</button>
    <h2>Ruang Pengumpulan Tugas</h2>
    <p>ID Kursus: <strong id="displayCourseId"></strong></p>
    
    <hr>
    <h3>Kumpulkan Tugas Anda</h3>
    <p style="font-size: 14px; color: gray;">Upload tugas ke Google Drive/GitHub, lalu paste linknya di bawah ini:</p>
    <input type="url" id="linkTugas" placeholder="https://drive.google.com/..." required>
    <button onclick="kumpulTugas()">Kirim Tugas</button>
    <p id="msg"></p>
</div>

<script>
    // MASUKKAN URL GOOGLE APPS SCRIPT DI BAWAH INI
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxDb1SezHX-15X4YGVyFMOTYhGo2DYXcDDhA7JEcRVDVeg_cKBrCcJTSqx8tWz2l1z7/exec";
    
    // Ambil ID Kursus dari URL (misal: course.html?id=CRS-001)
    const urlParams = new URLSearchParams(window.location.search);
    const courseId = urlParams.get('id');
    document.getElementById('displayCourseId').innerText = courseId;

    async function kumpulTugas() {
        const link = document.getElementById('linkTugas').value;
        const user = JSON.parse(localStorage.getItem("userLMS"));

        if(!user) return alert("Silakan login kembali!");
        if(!link) return alert("Link tugas tidak boleh kosong!");

        document.getElementById('msg').innerText = "Mengirim...";
        document.getElementById('msg').style.color = "orange";

        try {
            let response = await fetch(SCRIPT_URL, {
                method: "POST",
                body: JSON.stringify({ action: "submitTask", userId: user.id, courseId: courseId, linkTugas: link })
            });
            let result = await response.json();
            document.getElementById('msg').innerText = result.message;
            document.getElementById('msg').style.color = "green";
        } catch (e) {
            document.getElementById('msg').innerText = "Gagal mengirim.";
            document.getElementById('msg').style.color = "red";
        }
    }
</script>
</body>
</html>
